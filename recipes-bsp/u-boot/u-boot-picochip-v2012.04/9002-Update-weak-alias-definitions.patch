From 96dbfd23950d78c93f4e0c5af81af67a115ea87b Mon Sep 17 00:00:00 2001
From: Michael van der Westhuizen <r1mikey@gmail.com>
Date: Tue, 8 Sep 2015 11:32:41 +0200
Subject: [PATCH 2/5] Update weak alias definitions

---
 arch/arm/lib/board.c | 29 ++++++++++-------------------
 common/main.c        |  4 ++--
 2 files changed, 12 insertions(+), 21 deletions(-)

diff --git a/arch/arm/lib/board.c b/arch/arm/lib/board.c
index 5270c11..8b80326 100644
--- a/arch/arm/lib/board.c
+++ b/arch/arm/lib/board.c
@@ -39,6 +39,7 @@
  */
 
 #include <common.h>
+#include <linux/compiler.h>
 #include <command.h>
 #include <malloc.h>
 #include <stdio_dev.h>
@@ -83,25 +84,15 @@ extern void dataflash_print_info(void);
  ************************************************************************
  * May be supplied by boards if desired
  */
-inline void __coloured_LED_init(void) {}
-void coloured_LED_init(void)
-	__attribute__((weak, alias("__coloured_LED_init")));
-inline void __red_led_on(void) {}
-void red_led_on(void) __attribute__((weak, alias("__red_led_on")));
-inline void __red_led_off(void) {}
-void red_led_off(void) __attribute__((weak, alias("__red_led_off")));
-inline void __green_led_on(void) {}
-void green_led_on(void) __attribute__((weak, alias("__green_led_on")));
-inline void __green_led_off(void) {}
-void green_led_off(void) __attribute__((weak, alias("__green_led_off")));
-inline void __yellow_led_on(void) {}
-void yellow_led_on(void) __attribute__((weak, alias("__yellow_led_on")));
-inline void __yellow_led_off(void) {}
-void yellow_led_off(void) __attribute__((weak, alias("__yellow_led_off")));
-inline void __blue_led_on(void) {}
-void blue_led_on(void) __attribute__((weak, alias("__blue_led_on")));
-inline void __blue_led_off(void) {}
-void blue_led_off(void) __attribute__((weak, alias("__blue_led_off")));
+__weak void coloured_LED_init(void) {}
+__weak void red_led_on(void) {}
+__weak void red_led_off(void) {}
+__weak void green_led_on(void) {}
+__weak void green_led_off(void) {}
+__weak void yellow_led_on(void) {}
+__weak void yellow_led_off(void) {}
+__weak void blue_led_on(void) {}
+__weak void blue_led_off(void) {}
 
 /*
  ************************************************************************
diff --git a/common/main.c b/common/main.c
index db181d3..3fe3674 100644
--- a/common/main.c
+++ b/common/main.c
@@ -28,6 +28,7 @@
 /* #define	DEBUG	*/
 
 #include <common.h>
+#include <linux/compiler.h>
 #include <watchdog.h>
 #include <command.h>
 #include <version.h>
@@ -50,8 +51,7 @@ DECLARE_GLOBAL_DATA_PTR;
 /*
  * Board-specific Platform code can reimplement show_boot_progress () if needed
  */
-void inline __show_boot_progress (int val) {}
-void show_boot_progress (int val) __attribute__((weak, alias("__show_boot_progress")));
+__weak void show_boot_progress(int val) {}
 
 #if defined(CONFIG_UPDATE_TFTP)
 int update_tftp (ulong addr);
-- 
2.1.4

